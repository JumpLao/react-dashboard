!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?r(exports,require("react"),require("react-router-dom"),require("react-use")):"function"==typeof define&&define.amd?define(["exports","react","react-router-dom","react-use"],r):r(e.auth={},e.react,e.reactRouterDom,e.reactUse)}(this,function(e,r,t,n){var o="default"in r?r.default:r;"undefined"!=typeof Symbol&&(Symbol.iterator||(Symbol.iterator=Symbol("Symbol.iterator"))),"undefined"!=typeof Symbol&&(Symbol.asyncIterator||(Symbol.asyncIterator=Symbol("Symbol.asyncIterator")));var u=o.createContext({}),i=function(){var e=r.useContext(u);if(!e)throw new Error("useAuth should be use in side auth context");return e};e.AuthProvider=function(e){var i=e.children,c=e.forbiddenPath;void 0===c&&(c="/forbidden");var s=e.loadingComponent;void 0===s&&(s=function(){return o.createElement("div",null,"Loading")});var a=e.client;void 0===a&&(a={login:function(e){return Promise.resolve()},register:function(e){return Promise.resolve()},getUserInfo:function(){return Promise.resolve({id:1,name:"Mock"})},logout:function(){return Promise.resolve()}});var f=r.useState(),l=f[0],d=f[1],m=r.useState(!0),v=m[0],h=m[1],y=t.useHistory();if(n.useEffectOnce(function(){try{function e(){h(!1)}var r=function(e,r){try{var t=Promise.resolve(a.getUserInfo()).then(function(e){d(e)})}catch(e){return r()}return t&&t.then?t.then(void 0,r):t}(0,function(){console.log("Not authenticated")});return Promise.resolve(r&&r.then?r.then(e):e())}catch(e){return Promise.reject(e)}}),v)return s();var b=function(){try{return Promise.resolve(a.getUserInfo()).then(function(e){return d(e),e})}catch(e){return Promise.reject(e)}},P=Object.assign({},{user:l,onForbidden:function(){return y.push(c)}},a,{getUserInfo:b,login:function(e){try{return Promise.resolve(a.login(e)).then(function(){return Promise.resolve(b())})}catch(e){return Promise.reject(e)}},logout:function(){try{return Promise.resolve(a.logout()).then(function(){d(null)})}catch(e){return Promise.reject(e)}}});return o.createElement(u.Provider,{value:P},i)},e.useAuth=i,e.useAuthenticated=function(e){var r=i(),t=r.onForbidden;r.user||(e?e():t())}});
//# sourceMappingURL=index.umd.js.map
