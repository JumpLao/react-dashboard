!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("react"),require("react-router-dom"),require("react-use")):"function"==typeof define&&define.amd?define(["exports","react","react-router-dom","react-use"],t):t(e.auth={},e.react,e.reactRouterDom,e.reactUse)}(this,function(e,t,r,n){var o="default"in t?t.default:t;"undefined"!=typeof Symbol&&(Symbol.iterator||(Symbol.iterator=Symbol("Symbol.iterator"))),"undefined"!=typeof Symbol&&(Symbol.asyncIterator||(Symbol.asyncIterator=Symbol("Symbol.asyncIterator")));var u=o.createContext({}),i=function(){var e=t.useContext(u);if(!e)throw new Error("useAuth should be use in side auth context");return e};e.AuthProvider=function(e){var i=e.children,c=e.forbiddenPath;void 0===c&&(c="/forbidden");var s=e.loadingComponent;void 0===s&&(s=function(){return o.createElement("div",null,"Loading")});var a=e.client;void 0===a&&(a={login:function(e){return Promise.resolve()},register:function(e){return Promise.resolve()},getUserInfo:function(){return Promise.resolve({id:1,name:"Mock"})},logout:function(){return Promise.resolve()}});var f=t.useState(),l=f[0],d=f[1],m=t.useState(!0),v=m[0],h=m[1],y=r.useHistory();if(n.useEffectOnce(function(){!function(){try{var e=function(e,t){try{var r=function(e,t){try{var r=Promise.resolve(a.getUserInfo()).then(function(e){d(e)})}catch(e){return t()}return r&&r.then?r.then(void 0,t):r}(0,function(){console.log("Not authenticated")})}catch(e){return t(!0,e)}return r&&r.then?r.then(t.bind(null,!1),t.bind(null,!0)):t(!1,r)}(0,function(e,t){if(h(!1),e)throw t;return t});Promise.resolve(e&&e.then?e.then(function(){}):void 0)}catch(e){return Promise.reject(e)}}()}),v)return s();var b=function(){try{return Promise.resolve(a.getUserInfo()).then(function(e){return d(e),e})}catch(e){return Promise.reject(e)}},P=Object.assign({},{user:l,onForbidden:function(){return y.push(c)}},a,{getUserInfo:b,login:function(e){try{return Promise.resolve(a.login(e)).then(function(){return Promise.resolve(b())})}catch(e){return Promise.reject(e)}},logout:function(){try{return Promise.resolve(a.logout()).then(function(){d(null)})}catch(e){return Promise.reject(e)}}});return o.createElement(u.Provider,{value:P},i)},e.useAuth=i,e.useAuthenticated=function(e){var t=i(),r=t.onForbidden;t.user||(e?e():r())}});
//# sourceMappingURL=index.umd.js.map
