var e,r=require("react"),t=(e=r)&&"object"==typeof e&&"default"in e?e.default:e,n=require("react-router-dom"),o=require("react-use");"undefined"!=typeof Symbol&&(Symbol.iterator||(Symbol.iterator=Symbol("Symbol.iterator"))),"undefined"!=typeof Symbol&&(Symbol.asyncIterator||(Symbol.asyncIterator=Symbol("Symbol.asyncIterator")));var u=t.createContext({}),i=function(){var e=r.useContext(u);if(!e)throw new Error("useAuth should be use in side auth context");return e};exports.AuthProvider=function(e){var i=e.children,c=e.forbiddenPath;void 0===c&&(c="/forbidden");var s=e.loadingComponent;void 0===s&&(s=function(){return t.createElement("div",null,"Loading")});var a=e.client;void 0===a&&(a={login:function(e){return Promise.resolve()},register:function(e){return Promise.resolve()},getUserInfo:function(){return Promise.resolve({id:1,name:"Mock"})},logout:function(){return Promise.resolve()}});var l=r.useState(),f=l[0],d=l[1],m=r.useState(!0),v=m[0],h=m[1],y=n.useHistory();if(o.useEffectOnce(function(){try{function e(){h(!1)}var r=function(e,r){try{var t=Promise.resolve(a.getUserInfo()).then(function(e){d(e)})}catch(e){return r()}return t&&t.then?t.then(void 0,r):t}(0,function(){console.log("Not authenticated")});return Promise.resolve(r&&r.then?r.then(e):e())}catch(e){return Promise.reject(e)}}),v)return s();var b=function(){try{return Promise.resolve(a.getUserInfo()).then(function(e){return d(e),e})}catch(e){return Promise.reject(e)}},P=Object.assign({},{user:f,onForbidden:function(){return y.push(c)}},a,{getUserInfo:b,login:function(e){try{return Promise.resolve(a.login(e)).then(function(){return Promise.resolve(b())})}catch(e){return Promise.reject(e)}},logout:function(){try{return Promise.resolve(a.logout()).then(function(){d(null)})}catch(e){return Promise.reject(e)}}});return t.createElement(u.Provider,{value:P},i)},exports.useAuth=i,exports.useAuthenticated=function(e){var r=i(),t=r.onForbidden;r.user||(e?e():t())};
//# sourceMappingURL=index.js.map
